# Session 1: Plant Growth Case Study {-}

Learning Objectives: 

- Setting up Python
- Import data
- Performing descriptive and inferential statistics
- Plotting functions

## Set up your environment

```{r echo = FALSE}
knitr::opts_chunk$set(echo = TRUE)
Sys.setenv(PATH = paste("/anaconda3/bin", Sys.getenv("PATH"), sep=":"))
```

```{python echo = FALSE}

# import an entire library
import math

# Import an entire library and give it an alias
import pandas as pd
import numpy as np
import seaborn as sns
import statsmodels.api as sm

# Import only specific functions from a library 
from scipy import stats
from scipy.special import factorial
from statsmodels.formula.api import ols

```

## load dataset

```{python echo = FALSE}
plant_growth = pd.read_csv('data/plant_growth.csv')
```

```{python eval = FALSE}
plant_growth = pd.read_csv('data/Plant Growth.txt', delimiter="\t")
```

## Examine the data 

```{python}
# summaries
plant_growth.describe()
plant_growth['group'].value_counts()

# explore first dataset rows
plant_growth.head()

```

## Descriptive statistics

```{python}
# count group members
plant_growth['group'].value_counts()

# get average weight
np.mean(plant_growth['weight'])

```



## summary statistics

```{python}
plant_growth.groupby(['group']).describe()
df1 = plant_growth.groupby(['group']).mean()
df2 = plant_growth.groupby(['group']).std()
final_df = pd.concat([df1, df2], axis=1)

```

## Plot

Visualize weight per group

```{python eval = FALSE}
sns.boxplot(x='group', y='weight', data=plant_growth)
```

```{python, echo = FALSE}
print(sns.boxplot(x='group', y='weight', data=plant_growth))
```

## Inferential Statistics

### T-test

```{python}

# fit a linear model
# specify model
model = ols("weight ~ group", plant_growth)

# fit model
results = model.fit()

# explore model results
results.summary()

# extract coefficients
results.params.Intercept
results.params["group[T.trt1]"]
results.params["group[T.trt2]"]

```

### ANOVA

```{python}

# ANOVA
# compute anova
aov_table = sm.stats.anova_lm(results, typ=2)

# explore anova results
aov_table

```

```{python echo = FALSE}
print(aov_table)
```



### Exercises

```{exercise}
In the data folder you'll find another file called "Chick Weights.txt". 

Here you'll find the results from an experiment in which newly hatched chicks were randomly allocated into six groups. Each group was given a different feed supplement. After six weeks, their weights in grams were measured.

Using the commands we've learned so far complete the following tasks:

- Calculate the mean and standard deviation for each group.
- Calculate the number of chicks in each group.
- Calculate a within-group z-score.
- Produce a stripchart showing each chick as an individual data point
- Calculate a 1-way ANOVA.
- Calculate Tukey's post-hoc test (i.e. p-values for _all_ pair-wise t-tests)

```

```{python echo = FALSE, eval = FALSE}
sns.stripplot(x='group', y='weight', data=plant_growth, jitter=0.2)
```

The results from the posthoc test will be as follows

```{python, echo = FALSE}
# t-test
from statsmodels.stats.multicomp import pairwise_tukeyhsd
print(pairwise_tukeyhsd(plant_growth['weight'], plant_growth['group']))
```

